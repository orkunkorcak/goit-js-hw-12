{"version":3,"file":"index.js","sources":["../src/js/init.js","../src/main.js"],"sourcesContent":["window.global ||= window;\n","import \"./js/init\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nconst searchButton = document.querySelector(\".search-button\");\nconst moreButton = document.querySelector(\".more-button\");\nconst list = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nlet page = 1;\nlet totalHits = 0;\n\nasync function fetchData(page) {\n  const apiKey = \"48318006-868fd1918e5aa19d98c3706e2\";\n  const searchText = document.querySelector(\"#searchInput\").value.trim();\n\n  if (!searchText) {\n    iziToast.warning({\n      message: \"Please enter a search term!\",\n      position: \"topRight\",\n    });\n    return null;\n  }\n\n  const searchParams = new URLSearchParams({\n    q: searchText,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    per_page: \"40\",\n    page: page,\n  });\n\n  const searchUrlAdress = `https://pixabay.com/api/?key=${apiKey}&${searchParams}`;\n\n  try {\n    const response = await axios.get(searchUrlAdress);\n    const data = response.data;\n\n    if (!data.hits || data.hits.length === 0) {\n      iziToast.error({\n        message:\n          \"Sorry, there are no images matching your search query. Please try again!\",\n        position: \"topRight\",\n      });\n      return null;\n    }\n    totalHits = data.totalHits;\n    return data;\n  } catch (error) {\n    iziToast.error({\n      message: \"Failed to fetch data. Please check your internet connection.\",\n      position: \"topRight\",\n    });\n    return null;\n  }\n}\n\nfunction renderData(data) {\n  const markup = data.hits\n    .map((image) => {\n      return `\n             <a href=\"${image.largeImageURL}\" class=\"image-card\">\n                 <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n                 <div class=\"image-info\">\n                   <div class=\"likes\">\n                     <p class=\"likes-text\">Likes</p>\n                     <p class=\"likes-count\">${image.likes}</p>\n                   </div>\n                   <div class=\"views\">\n                     <p class=\"views-text\">Views</p>\n                     <p class=\"views-count\">${image.views}</p>\n                   </div>\n                   <div class=\"comments\">\n                     <p class=\"comments-text\">Comments</p>\n                     <p class=\"comments-count\">${image.comments}</p>\n                   </div>\n                   <div class=\"downloads\">\n                     <p class=\"downloads-text\">Downloads</p>\n                     <p class=\"downloads-count\">${image.downloads}</p>\n                   </div>\n                 </div>\n               </a>\n          `;\n    })\n    .join(\"\");\n  list.insertAdjacentHTML(\"beforeend\", markup);\n  lightbox.refresh();\n}\n\nsearchButton.addEventListener(\"click\", async (event) => {\n  event.preventDefault();\n  page = 1;\n  list.innerHTML = \"\";\n  loader.style.display = \"flex\";\n  moreButton.style.display = \"none\";\n\n  try {\n    const data = await fetchData(page);\n    if (data) {\n      renderData(data);\n      page += 1;\n      if (totalHits > 40) {\n        moreButton.style.display = \"flex\";\n      }\n    }\n  } catch (error) {\n    iziToast.error({\n      message: \"Something went wrong! Please try again.\",\n      position: \"topRight\",\n    });\n  } finally {\n    loader.style.display = \"none\";\n  }\n});\n\nmoreButton.addEventListener(\"click\", async (event) => {\n  event.preventDefault();\n\n  if ((page - 1) * 40 >= totalHits) {\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: \"topRight\",\n    });\n    moreButton.style.display = \"none\";\n    return;\n  }\n\n  try {\n    const data = await fetchData(page);\n    if (data) {\n      const firstNewImage = list.lastElementChild; \n      renderData(data);\n      page += 1;\n\n      \n      if (firstNewImage) {\n        const { height } = firstNewImage.getBoundingClientRect();\n        window.scrollBy({ top: height * 2, behavior: \"smooth\" });\n      }\n\n      \n      // if ((page - 1) * 40 >= totalHits) {\n      //   moreButton.style.display = \"none\";\n      // }\n    }\n  } catch (error) {\n    iziToast.error({\n      message: \"Something went wrong! Please try again.\",\n      position: \"topRight\",\n    });\n  }\n});\n"],"names":["lightbox","SimpleLightbox","searchButton","moreButton","list","loader","page","totalHits","fetchData","apiKey","searchText","iziToast","searchParams","searchUrlAdress","data","axios","renderData","markup","image","event","firstNewImage","height"],"mappings":"+vBAAA,OAAO,SAAP,OAAO,OAAW,QCOlB,MAAMA,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAe,SAAS,cAAc,gBAAgB,EACtDC,EAAa,SAAS,cAAc,cAAc,EAClDC,EAAO,SAAS,cAAc,UAAU,EACxCC,EAAS,SAAS,cAAc,SAAS,EAC/C,IAAIC,EAAO,EACPC,EAAY,EAEhB,eAAeC,EAAUF,EAAM,CAC7B,MAAMG,EAAS,qCACTC,EAAa,SAAS,cAAc,cAAc,EAAE,MAAM,KAAM,EAEtE,GAAI,CAACA,EACH,OAAAC,EAAS,QAAQ,CACf,QAAS,8BACT,SAAU,UAChB,CAAK,EACM,KAGT,MAAMC,EAAe,IAAI,gBAAgB,CACvC,EAAGF,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAU,KACV,KAAMJ,CACV,CAAG,EAEKO,EAAkB,gCAAgCJ,CAAM,IAAIG,CAAY,GAE9E,GAAI,CAEF,MAAME,GADW,MAAMC,EAAM,IAAIF,CAAe,GAC1B,KAEtB,MAAI,CAACC,EAAK,MAAQA,EAAK,KAAK,SAAW,GACrCH,EAAS,MAAM,CACb,QACE,2EACF,SAAU,UAClB,CAAO,EACM,OAETJ,EAAYO,EAAK,UACVA,EACR,MAAe,CACd,OAAAH,EAAS,MAAM,CACb,QAAS,+DACT,SAAU,UAChB,CAAK,EACM,IACX,CACA,CAEA,SAASK,EAAWF,EAAM,CACxB,MAAMG,EAASH,EAAK,KACjB,IAAKI,GACG;AAAA,wBACWA,EAAM,aAAa;AAAA,6BACdA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA,8CAIrBA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,8CAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,iDAIRA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,kDAIbA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA,WAK5D,EACA,KAAK,EAAE,EACVd,EAAK,mBAAmB,YAAaa,CAAM,EAC3CjB,EAAS,QAAS,CACpB,CAEAE,EAAa,iBAAiB,QAAS,MAAOiB,GAAU,CACtDA,EAAM,eAAgB,EACtBb,EAAO,EACPF,EAAK,UAAY,GACjBC,EAAO,MAAM,QAAU,OACvBF,EAAW,MAAM,QAAU,OAE3B,GAAI,CACF,MAAMW,EAAO,MAAMN,EAAUF,CAAI,EAC7BQ,IACFE,EAAWF,CAAI,EACfR,GAAQ,EACJC,EAAY,KACdJ,EAAW,MAAM,QAAU,QAGhC,MAAe,CACdQ,EAAS,MAAM,CACb,QAAS,0CACT,SAAU,UAChB,CAAK,CACL,QAAY,CACRN,EAAO,MAAM,QAAU,MAC3B,CACA,CAAC,EAEDF,EAAW,iBAAiB,QAAS,MAAOgB,GAAU,CAGpD,GAFAA,EAAM,eAAgB,GAEjBb,EAAO,GAAK,IAAMC,EAAW,CAChCI,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UAChB,CAAK,EACDR,EAAW,MAAM,QAAU,OAC3B,MACJ,CAEE,GAAI,CACF,MAAMW,EAAO,MAAMN,EAAUF,CAAI,EACjC,GAAIQ,EAAM,CACR,MAAMM,EAAgBhB,EAAK,iBAK3B,GAJAY,EAAWF,CAAI,EACfR,GAAQ,EAGJc,EAAe,CACjB,KAAM,CAAE,OAAAC,CAAM,EAAKD,EAAc,sBAAuB,EACxD,OAAO,SAAS,CAAE,IAAKC,EAAS,EAAG,SAAU,SAAU,CAC/D,CAMA,CACG,MAAe,CACdV,EAAS,MAAM,CACb,QAAS,0CACT,SAAU,UAChB,CAAK,CACL,CACA,CAAC"}